# Enable URL rewriting
RewriteEngine On

# Set the base directory
RewriteBase /GGGG/api/

# Handle preflight OPTIONS requests first
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ index.php [L]

# Redirect requests to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [L]

# Set default character encoding
AddDefaultCharset UTF-8

# Enable CORS headers
<IfModule mod_headers.c>
    # Allow from any origin
    Header always set Access-Control-Allow-Origin "*"
    
    # Allow specific methods
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    
    # Allow specific headers
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    
    # Allow credentials
    Header always set Access-Control-Allow-Credentials "true"
    
    # Cache preflight requests
    Header always set Access-Control-Max-Age "86400"
</IfModule>

# PHP settings (if needed)
<IfModule mod_php7.c>
    php_flag display_errors Off
    php_value error_reporting E_ALL & ~E_DEPRECATED & ~E_STRICT
    php_value max_execution_time 300
    php_value upload_max_filesize 5M
    php_value post_max_size 10M
</IfModule>

<IfModule mod_php8.c>
    php_flag display_errors Off
    php_value error_reporting E_ALL & ~E_DEPRECATED & ~E_STRICT
    php_value max_execution_time 300
    php_value upload_max_filesize 5M
    php_value post_max_size 10M
</IfModule>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Hide .htaccess file
<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>

# Hide sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

<FilesMatch "\.(log|txt|md)$">
    Order allow,deny
    Deny from all
</FilesMatch>
