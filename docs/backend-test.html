<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backend Connection Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üîß Backend Connection Test</h1>
    <p>Testing Graceland Royal Academy Backend API</p>

    <div class="test-section info">
        <h3>üìã Test Instructions</h3>
        <ol>
            <li>Make sure XAMPP is running (Apache + MySQL)</li>
            <li>Make sure database 'graceland_academy' exists</li>
            <li>Click each test button below</li>
            <li>Check results for success/failure</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>üîó Database Connection Test</h3>
        <button onclick="testDatabaseConnection()">Test Database API</button>
        <div id="database-result"></div>
    </div>

    <div class="test-section">
        <h3>üîê Authentication Test</h3>
        <button onclick="testAuthentication()">Test Login API</button>
        <div id="auth-result"></div>
    </div>

    <div class="test-section">
        <h3>üìä Data Query Test</h3>
        <button onclick="testDataQuery()">Test Student Query</button>
        <div id="query-result"></div>
    </div>

    <script>
        function showResult(elementId, result, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.className = 'test-section ' + (isSuccess ? 'success' : 'error');
            element.innerHTML = `
                <h4>${isSuccess ? '‚úÖ Success' : '‚ùå Error'}</h4>
                <pre>${JSON.stringify(result, null, 2)}</pre>
            `;
        }

        async function testDatabaseConnection() {
            try {
                const response = await fetch('http://localhost/GGGG/api/database/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: 'SELECT 1 as test, NOW() as current_time',
                        params: []
                    })
                });

                const result = await response.json();
                showResult('database-result', result, response.ok && result.success);
            } catch (error) {
                showResult('database-result', { error: error.message }, false);
            }
        }

        async function testAuthentication() {
            try {
                const response = await fetch('http://localhost/GGGG/api/auth/simple_login.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        username: 'admin',
                        password: 'admin123',
                        role: 'admin'
                    })
                });

                const result = await response.json();
                showResult('auth-result', result, response.ok && result.success);
            } catch (error) {
                showResult('auth-result', { error: error.message }, false);
            }
        }

        async function testDataQuery() {
            try {
                const response = await fetch('http://localhost/GGGG/api/database/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: 'SELECT COUNT(*) as total FROM users',
                        params: []
                    })
                });

                const result = await response.json();
                showResult('query-result', result, response.ok && result.success);
            } catch (error) {
                showResult('query-result', { error: error.message }, false);
            }
        }
    </script>
</body>
</html>
